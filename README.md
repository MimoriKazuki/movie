# 教育動画プラットフォーム

Next.js、Supabase、Vimeo APIを使用した教育動画配信プラットフォームです。

## 機能一覧

- ユーザー認証（登録・ログイン）
- 動画視聴（Vimeo Player連携）
- 視聴履歴の自動記録
- お気に入り機能
- コメント機能
- 動画検索（タイトル、ジャンル、タグ）
- 管理者機能（動画アップロード、編集、削除）

## セットアップ

### 1. 必要な環境

- Node.js 18以上
- Supabaseアカウント
- Vimeoアカウント（動画ホスティング用）

### 2. インストール

```bash
npm install
```

### 3. 環境変数の設定

`.env.local`ファイルを作成し、以下の環境変数を設定：

```env
NEXT_PUBLIC_SUPABASE_URL=your-supabase-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key
```

### 4. データベースのセットアップ

Supabaseのダッシュボードで`supabase/schema.sql`のSQLを実行してテーブルを作成します。

### 5. 開発サーバーの起動

```bash
npm run dev
```

http://localhost:3000 でアプリケーションが起動します。

## 動画の投稿方法

### 1. 管理者アカウントの作成

1. まず通常のユーザーとして登録します
2. Supabaseのダッシュボードで`profiles`テーブルを開きます
3. 該当ユーザーの`role`を`user`から`admin`に変更します

### 2. Vimeoで動画をアップロード

1. [Vimeo](https://vimeo.com)にログイン
2. 動画をアップロード
3. 動画のURLから数字のIDを取得（例: `https://vimeo.com/123456789` → `123456789`）

### 3. プラットフォームで動画を登録

1. 管理者アカウントでログイン
2. ナビゲーションの「管理者」をクリック
3. 「新規動画追加」ボタンをクリック
4. 以下の情報を入力：
   - タイトル（必須）
   - Vimeo ID（必須）- Vimeoの動画URLの数字部分
   - 説明（任意）
   - ジャンル（任意）
   - タグ（任意）- カンマ区切りで複数指定可能
   - 公開設定 - チェックを入れると公開
5. 「保存」をクリック

### 4. 動画の管理

管理者ダッシュボードでは以下の操作が可能です：

- **公開/非公開の切り替え** - 目のアイコンをクリック
- **編集** - 鉛筆アイコンをクリック
- **削除** - ゴミ箱アイコンをクリック

## 使い方

### ユーザー向け機能

1. **動画視聴** - ダッシュボードや動画一覧から動画を選択
2. **検索** - ヘッダーの検索ボックスまたは詳細検索ページから
3. **お気に入り** - 動画詳細ページでハートアイコンをクリック
4. **コメント** - 動画詳細ページでコメントを投稿
5. **マイページ** - お気に入り、視聴履歴、プロフィール設定

### 管理者向け機能

1. **動画管理** - `/admin`にアクセス
2. **統計確認** - 総動画数、総視聴回数、公開動画数
3. **動画の追加/編集/削除** - 管理者ダッシュボードから

## トラブルシューティング

### 動画が表示されない場合

1. Vimeo IDが正しいか確認
2. 動画が公開設定になっているか確認
3. Vimeoの動画自体が視聴可能な状態か確認

### 管理者ページにアクセスできない場合

1. Supabaseで`profiles`テーブルの`role`が`admin`になっているか確認
2. 一度ログアウトして再ログイン